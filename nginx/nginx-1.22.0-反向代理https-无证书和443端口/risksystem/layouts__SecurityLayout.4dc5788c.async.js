(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{GHBU:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var r=n("XEnU"),a=n("c1Ei"),c=n.n(a),o=n("5Tp6"),s=n("t3Un"),u=n("+n12");function i(e){return l.apply(this,arguments)}function l(){return l=Object(o["a"])(c.a.mark((function e(t){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s["a"])("".concat("/service","/api/UserEvent/GetCurrentUserMenuEvents"),{method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return f=Object(o["a"])(c.a.mark((function e(t){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s["a"])("".concat("/service","/api/UserEvent/GetSystemLog"),{method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function d(e,t){return h.apply(this,arguments)}function h(){return h=Object(o["a"])(c.a.mark((function e(t,n){var a,o,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return a=Object(r["a"])(Object(r["a"])({},n),{},{uEventType:t,uEventUrl:window.location.href}),"PageView"===t&&(o=Object(u["n"])(),i=o.menuId,a.ueAttr1=i||null),e.abrupt("return",Object(s["a"])("".concat("/service","/api/UserEvent/CreateUserEvent"),{method:"POST",body:a}));case 4:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return y=Object(o["a"])(c.a.mark((function e(t){var n;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=null===t||void 0===t?void 0:t.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{uEventUrl:window.location.href})})),e.abrupt("return",Object(s["a"])("".concat("/service","/api/UserEvent/CreateUserEvents"),{method:"POST",body:n}));case 2:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}},L9NX:function(e,t,n){"use strict";n.r(t);var r=n("XKWP"),a=n("N7Kx"),c=n("kFHX"),o=n("4jIl"),s=n("q1tI"),u=n.n(s),i=n("MuoO"),l=n("Jdo2"),p=n("LvDl"),f=n.n(p),d=n("GHBU"),h=n("tBqH"),m=n("58ak"),y=n("HUA2"),v=n("k9Yu"),b=n("+n12"),g=function(e){Object(c["a"])(n,e);var t=Object(o["a"])(n);function n(){var e;Object(r["a"])(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),e.state={menuDataIsReady:!1,userIsReady:!1},e.getUserInfo=function(){var t=e.props,n=t.dispatch,r=(t.location,y["a"]().then((function(e){var t=null;return 0===e.errorCode&&(t=e.result),Promise.all([t])}))),a=m["d"]().then((function(e){var t=null;return 0===e.errorCode&&(t=e.result),Promise.all([t])})),c=Object(v["c"])().then((function(e){var t=null;return 0===e.errorCode&&(t=e.result),Promise.all([t])}));Promise.all([r,a,c]).then((function(t){if(!f.a.isEmpty(t[0][0])&&!f.a.isEmpty(t[1][0])&&!f.a.isEmpty(t[2][0])){var r=t[0][0],a=r.system,c=r.systemConfigs,o=t[1][0],s=o.currentTenant,u=o.tenantConfigs,i=o.tenantHomeUrls,l=t[2][0],p=l.currentUser,d=l.userConfigs,y=a.pmsCodes||0;if(s||Object(h["b"])(y,h["a"].SystemAdmin)){var v={},g={},w={},O={};c&&c.length&&c.forEach((function(e){g[e.cfgCode]=e.cfgValue})),u&&u.length&&u.forEach((function(e){w[e.cfgCode]=e.cfgValue})),d&&d.length&&d.forEach((function(e){O[e.cfgCode]=e.cfgValue})),f.a.merge(v,g),f.a.merge(v,w),f.a.merge(v,O),n({type:"system/save",payload:{system:a,systemConfigs:c}}),n({type:"tenant/save",payload:{currentTenant:s||{},tenantConfigs:u,tenantHomeUrls:i}}),n({type:"user/save",payload:{currentUser:p,userConfig:v}}),Object(b["q"])(v.DefualtTheme),e.setState({userIsReady:!0})}else m["f"]({filter:""}).then((function(e){if(0===e.errorCode&&e.result){var t=e.result.find((function(e){return Object(h["b"])(e.pmsCodes,h["a"].TenantAccess)}));t?Object(b["p"])(t.tenantId):m["g"]({tenantId:"5836277e-10e1-4c26-8e32-675ab61b9070"}).then((function(e){if(0===e.errorCode){var t="".concat(window.location.href.split("/page/")[0],"/page/");window.location.href=t}}))}}))}}))},e}return Object(a["a"])(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.dispatch,r=t.location;Object(d["a"])("PageView"),n&&(n({type:"menu/getUserMenus",callback:function(t){0===t.errorCode&&(n({type:"menu/getCurrentMenu",payload:{location:r}}),e.setState({menuDataIsReady:!0}))}}),n({type:"userResRel/getUserResRels"}),n({type:"dictionary/getDictionaries"})),this.getUserInfo();var a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.href="https://cdn.syncfusion.com/ej2/material.css",document.head.appendChild(a)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.location,n=e.dispatch,r=this.props.location;t.pathname===r.pathname&&t.search===r.search||(window.scrollTo(0,0),n({type:"menu/getCurrentMenu",payload:{location:t}}),Object(d["a"])("PageView"))}},{key:"render",value:function(){var e=this.state,t=e.menuDataIsReady,n=e.userIsReady,r=this.props,a=r.children,c=r.loading,o=r.currentUser,s=o&&o.userId;return!s&&c||!t||!n?u.a.createElement(l["a"],null):a}}]),n}(u.a.Component);t["default"]=Object(i["connect"])((function(e){var t=e.user,n=e.loading;return{currentUser:t.currentUser,loading:n.models.user}}))(g)}}]);